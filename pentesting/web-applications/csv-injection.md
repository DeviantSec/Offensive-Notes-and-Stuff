# CSV Injection

CSV/Formula Injection occurs when websites embed untrusted input inside CSV files. This often occurs when a user has write access over a data entry that can be exported by a manager or administrator of the application. An attacker can craft a malicious formula to redirect the user to a phishing site or execute a reverse shell on the system.&#x20;

### Testing

Input one of the following formulas into an exported field and download the document to see if it executes successfully.

{% hint style="warning" %}
Often times for these to work, you will need to have configured Excel with the following: \
File → Options → Trust Center → Trust Center Settings → External Content → Enable Dynamic Data Exchange Server Launch
{% endhint %}

```bash
=1336+1
=HYPERLINK("https://parzival.sh")
=cmd|' /C calc'!xxx
```

### Mitigations

> One of the most basic recommendations to remediate CSV Injection, ensure that no cells begin with any of the following characters:\
>
>
> * Equals to (`=`)
> * Plus (`+`)
> * Minus (`-`)
> * At (`@`)
> * Tab (`0x09`)
> * Carriage return (`0x0D`)

It is recommended to reference the article provided by OWASP on mitigating CSV Injection to completely remediate this vulnerability. It should also be noted that this attack can often times be difficult to mitigate.&#x20;

### References

{% embed url="https://owasp.org/www-community/attacks/CSV_Injection" %}
