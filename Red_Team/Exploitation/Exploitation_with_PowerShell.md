# Exploitation with PowerShell

**Description:** Various commands related to PowerShell usage during penetration tests or red team engagements.

### Enumerate Installed Versions

**Information:** This can be helpful when determining if a PowerShell downgrade attack will work. \
`(Get-ItemProperty HKLM:\SOFTWARE\Microsoft\PowerShell\*\PowerShellEngin e -Name PowerShellVersion).PowerShellVersion`

If PowerShell 2.0 is installed then we can bypass multiple security protections enabled in more recent PowerShell Version 5 releases: \
`powershell.exe -Version 2`

### Bypassing Execution Policy
**Information:** Execution policies can be disabled in multiple ways. It is not a sufficient security protection to prevent unsigned scripts from being loaded. \
`powershell.exe -exec bypass` \
`Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process`

### Creating a PowerShell Session
**Information:** We can establish a persistent connection in PowerShell using Enter-PSSession. This can make life significantly easier and reduce overhead. \
`New-PSSession -ComputerName [IP] -Credential [USER] \`
`Enter-PSSession -Session #`

### Executing Scripts Remotely
**Information:** We can execute scripts remotely with PowerShell. \
`Invoke-Command -Session # -FilePath C:\Users\Parzival\Desktop\Mimikatz.exe`
